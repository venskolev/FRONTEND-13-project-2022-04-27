{"ast":null,"code":"var _jsxFileName = \"/home/user/Documents/DCI/backand/BACKEND-13-project-2022-04-27/frontend/src/components/home.js\";\nimport React, { useState, useEffect } from 'react';\nimport { setUserList } from '../redux/action-creators/users';\nimport { connect } from 'react-redux';\nimport { initUser, initEdit, deleteUser } from '../redux/action-creators/users';\nimport { Loading, Alert } from './utils';\nimport Table from './table';\n\nconst Home = _ref => {\n  let {\n    users,\n    setUserList,\n    history,\n    initUser,\n    initEdit,\n    deleteUser,\n    isLoading,\n    error,\n    deleteError\n  } = _ref;\n  useEffect(() => {\n    initUser();\n    initEdit();\n    setUserList();\n  }, []);\n  const [query, setQuery] = useState('');\n  const [goToPage, setGoToPage] = useState('');\n  const [actAttr, setActAttr] = useState('');\n  const [sortType, setSortType] = useState(0); // default/asc/desc\n\n  const [queryCur, setQueryCur] = useState(''); // store the query for search\n\n  const [activePage, setActivePage] = useState(1); // current page\n  // sortType: 1 for ascend, 2 for descend, 0 for default\n  // if need remember page back, try redux\n  // function define part *****\n  // handle functions, process logic and actions\n\n  const handleChange = e => {\n    if (e.target.id === 'search') {\n      setQuery(e.target.value);\n    } else if (e.target.id === 'goto') {\n      setGoToPage(e.target.value);\n    }\n  };\n\n  const handleCreate = e => {\n    history.push('/createuser');\n  };\n\n  const handleSearch = e => {\n    e.preventDefault(); // protect out of page\n\n    setActivePage(1);\n    setQueryCur(query);\n  };\n\n  const handleEdit = id => {\n    history.push(`/edituser/${id}`);\n  };\n\n  const handleDelete = id => {\n    deleteUser(id); // setDeleteId(id);\n  };\n\n  const handlePageGoTo = e => {\n    // console.log(e.target.tagName); // FORM\n    e.preventDefault();\n    if (!isNaN(goToPage) && goToPage >= 1 && goToPage <= parseInt((activeUser(queryCur, sortType, users, actAttr).length - 1) / maxRowsPerPage) + 1) setActivePage(parseInt(goToPage)); // prevent invalid input\n    // in case decimal: 1.2, 2.6, ...\n  };\n\n  const handleSort = e => {\n    if (e.target.id === actAttr) {\n      setSortType((sortType + 1) % 3);\n    } else {\n      setSortType(1);\n    } // Clear the sort type from another attribute\n\n\n    setActAttr(e.target.id);\n  }; // -------------------------------------------------------\n  // child function for selectUser, sort logic\n\n\n  const sortUserByAttr = (users, attribute) => {\n    // Don't change the USERS array!\n    // ignore Upper and Lower differences, sex can be F/M or whole word\n    switch (attribute) {\n      case 'firstname':\n        return [...users].sort((a, b) => a.firstname.toLowerCase() > b.firstname.toLowerCase() ? 1 : a.firstname.toLowerCase() === b.firstname.toLowerCase() ? a.lastname.toLowerCase() > b.lastname.toLowerCase() ? 1 : a.lastname.toLowerCase() === b.lastname.toLowerCase() ? a.age > b.age ? 1 : a.age === b.age ? a.sex.toLowerCase().slice(0, 1) > b.sex.toLowerCase().slice(0, 1) ? 1 : -1 : -1 : -1 : -1);\n\n      case 'lastname':\n        return [...users].sort((a, b) => a.lastname.toLowerCase() > b.lastname.toLowerCase() ? 1 : a.lastname.toLowerCase() === b.lastname.toLowerCase() ? a.firstname.toLowerCase() > b.firstname.toLowerCase() ? 1 : a.firstname.toLowerCase() === b.firstname.toLowerCase() ? a.age > b.age ? 1 : a.age === b.age ? a.sex.toLowerCase().slice(0, 1) > b.sex.toLowerCase().slice(0, 1) ? 1 : -1 : -1 : -1 : -1);\n\n      case 'sex':\n        return [...users].sort((a, b) => a.sex.toLowerCase().slice(0, 1) > b.sex.toLowerCase().slice(0, 1) ? 1 : a.sex.toLowerCase().slice(0, 1) === b.sex.toLowerCase().slice(0, 1) ? a.firstname.toLowerCase() > b.firstname.toLowerCase() ? 1 : a.firstname.toLowerCase() === b.firstname.toLowerCase() ? a.lastname.toLowerCase() > b.lastname.toLowerCase() ? 1 : a.lastname.toLowerCase() === b.lastname.toLowerCase() ? a.age > b.age ? 1 : -1 : -1 : -1 : -1);\n\n      case 'age':\n        // console.log([...users][0].age);\n        return [...users].sort((a, b) => a.age > b.age ? 1 : a.age === b.age ? a.firstname.toLowerCase() > b.firstname.toLowerCase() ? 1 : a.firstname.toLowerCase() === b.firstname.toLowerCase() ? a.lastname.toLowerCase() > b.lastname.toLowerCase() ? 1 : a.lastname.toLowerCase() === b.lastname.toLowerCase() ? a.sex.toLowerCase().slice(0, 1) > b.sex.toLowerCase().slice(0, 1) ? 1 : -1 : -1 : -1 : -1);\n\n      default:\n        return [...users];\n    }\n  }; // @ searchUser, selectUser are child functions for setActiveUser\n\n\n  const searchUser = (users, queryCur) => {\n    // this func filter users based on search query\n    return users.filter(user => user.firstname.toLowerCase().indexOf(queryCur.toString().toLowerCase()) !== -1 || user.lastname.toLowerCase().indexOf(queryCur.toString().toLowerCase()) !== -1 || user.sex.toLowerCase().indexOf(queryCur.toString().toLowerCase()) !== -1 || user.age.toString().indexOf(queryCur.toString()) !== -1);\n  };\n\n  const selectSort = (sortType, users, actAttr) => {\n    // this func sort users based on sort type\n    switch (sortType) {\n      case 1:\n        return sortUserByAttr(users, actAttr);\n\n      case 2:\n        return [...sortUserByAttr(users, actAttr)].reverse();\n\n      default:\n        return users;\n    }\n  }; // IMPORTANT function to calculate active users\n\n\n  const activeUser = (queryCur, sortType, users, actAttr) => {\n    // this func return results after search and then sorting\n    if (queryCur) {\n      const searchedUsers = searchUser(users, queryCur);\n      return selectSort(sortType, searchedUsers, actAttr);\n    } else {\n      return selectSort(sortType, users, actAttr);\n    }\n  }; // old expression:\n  // (queryCur\n  //   ? (sortType === 1\n  //       ? sortUserByAttr(users, actAttr)\n  //       : sortType === 2\n  //       ? [...sortUserByAttr(users, actAttr).reverse()]\n  //       : users\n  //     ).filter(user => searchUser(user, queryCur))\n  //   : sortType === 1\n  //   ? sortUserByAttr(users, actAttr)\n  //   : sortType === 2\n  //   ? [...sortUserByAttr(users, actAttr).reverse()]\n  //   : users\n  // )\n  // ------------------------------------------------------------\n  //render part ********\n\n\n  if (activeUser(queryCur, sortType, users, actAttr).length > 0 && activeUser(queryCur, sortType, users, actAttr).length === (activePage - 1) * maxRowsPerPage) {\n    // if it is this page's last user, after delete, back to prev page\n    // empty list stay in 1st page\n    setActivePage(activePage - 1);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"nav\", {\n    className: \"navbar navbar-light bg-light\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"navbar-brand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }\n  }, \"User List\"), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"form-inline\",\n    onSubmit: e => handlePageGoTo(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 9\n    }\n  }, \"Go to page:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mr-sm-2\",\n    type: \"goto\",\n    placeholder: \"Go to page\",\n    \"aria-label\": \"GoTo\",\n    id: \"goto\",\n    value: goToPage,\n    onChange: e => handleChange(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"form-inline\",\n    onSubmit: e => handleSearch(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 9\n    }\n  }, \"Search:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mr-sm-2\",\n    type: \"search\",\n    placeholder: \"Search\",\n    \"aria-label\": \"Search\",\n    id: \"search\",\n    value: query,\n    onChange: e => handleChange(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-outline-success\",\n    onClick: e => handleCreate(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-user\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 11\n    }\n  }), \" Create\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }\n  }, isLoading ? /*#__PURE__*/React.createElement(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    queryCur: queryCur,\n    sortType: sortType,\n    users: users,\n    actAttr: actAttr,\n    maxRowsPerPage: maxRowsPerPage,\n    activeUser: activeUser,\n    activePage: activePage,\n    handleDelete: handleDelete,\n    handleEdit: handleEdit,\n    handleSort: handleSort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Pagination, {\n    queryCur: queryCur,\n    sortType: sortType,\n    users: users,\n    actAttr: actAttr,\n    maxRowsPerPage: maxRowsPerPage,\n    activeUser: activeUser,\n    activePage: activePage,\n    setActivePage: setActivePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 13\n    }\n  }), error && /*#__PURE__*/React.createElement(Alert, {\n    waring: \"server\",\n    item: \"get\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 23\n    }\n  }), deleteError && /*#__PURE__*/React.createElement(Alert, {\n    waring: \"server\",\n    item: \"delete\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 29\n    }\n  }))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    users: state.users.users,\n    isLoading: state.users.isLoading,\n    error: state.users.error,\n    deleteError: state.users.deleteError\n  };\n};\n\nconst mapStateToDispatch = dispatch => {\n  return {\n    setUserList: () => dispatch(setUserList()),\n    initUser: () => dispatch(initUser()),\n    initEdit: () => dispatch(initEdit()),\n    deleteUser: id => dispatch(deleteUser(id))\n  };\n};\n\nexport default connect(mapStateToProps, mapStateToDispatch)(Home);","map":{"version":3,"sources":["/home/user/Documents/DCI/backand/BACKEND-13-project-2022-04-27/frontend/src/components/home.js"],"names":["React","useState","useEffect","setUserList","connect","initUser","initEdit","deleteUser","Loading","Alert","Table","Home","users","history","isLoading","error","deleteError","query","setQuery","goToPage","setGoToPage","actAttr","setActAttr","sortType","setSortType","queryCur","setQueryCur","activePage","setActivePage","handleChange","e","target","id","value","handleCreate","push","handleSearch","preventDefault","handleEdit","handleDelete","handlePageGoTo","isNaN","parseInt","activeUser","length","maxRowsPerPage","handleSort","sortUserByAttr","attribute","sort","a","b","firstname","toLowerCase","lastname","age","sex","slice","searchUser","filter","user","indexOf","toString","selectSort","reverse","searchedUsers","mapStateToProps","state","mapStateToDispatch","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { setUserList } from '../redux/action-creators/users';\nimport { connect } from 'react-redux';\nimport { initUser, initEdit, deleteUser } from '../redux/action-creators/users';\nimport { Loading, Alert } from './utils';\nimport Table from './table';\n\nconst Home = ({\n  users,\n  setUserList,\n  history,\n  initUser,\n  initEdit,\n  deleteUser,\n  isLoading,\n  error,\n  deleteError\n}) => {\n  useEffect(() => {\n    initUser();\n    initEdit();\n    setUserList();\n  }, []); \n\n  const [query, setQuery] = useState(''); \n  const [goToPage, setGoToPage] = useState(''); \n\n  const [actAttr, setActAttr] = useState(''); \n  const [sortType, setSortType] = useState(0); // default/asc/desc\n  const [queryCur, setQueryCur] = useState(''); // store the query for search\n\n  const [activePage, setActivePage] = useState(1); // current page\n\n  // sortType: 1 for ascend, 2 for descend, 0 for default\n  // if need remember page back, try redux\n\n  // function define part *****\n\n  // handle functions, process logic and actions\n  const handleChange = e => {\n    if (e.target.id === 'search') {\n      setQuery(e.target.value);\n    } else if (e.target.id === 'goto') {\n      setGoToPage(e.target.value);\n    }\n  };\n\n  const handleCreate = e => {\n    history.push('/createuser');\n  };\n\n  const handleSearch = e => {\n    e.preventDefault();\n    // protect out of page\n    setActivePage(1);\n    setQueryCur(query);\n  };\n\n  const handleEdit = id => {\n    history.push(`/edituser/${id}`);\n  };\n\n  const handleDelete = id => {\n    deleteUser(id);\n    // setDeleteId(id);\n  };\n\n  const handlePageGoTo = e => {\n    // console.log(e.target.tagName); // FORM\n    e.preventDefault();\n    if (\n      !isNaN(goToPage) &&\n      goToPage >= 1 &&\n      goToPage <=\n        parseInt(\n          (activeUser(queryCur, sortType, users, actAttr).length - 1) /\n            maxRowsPerPage\n        ) +\n          1\n    )\n      setActivePage(parseInt(goToPage)); // prevent invalid input\n    // in case decimal: 1.2, 2.6, ...\n  };\n\n  const handleSort = e => {\n    if (e.target.id === actAttr) {\n      setSortType((sortType + 1) % 3);\n    } else {\n      setSortType(1);\n    }\n    // Clear the sort type from another attribute\n    setActAttr(e.target.id);\n  };\n\n  // -------------------------------------------------------\n  // child function for selectUser, sort logic\n  const sortUserByAttr = (users, attribute) => {\n    // Don't change the USERS array!\n    // ignore Upper and Lower differences, sex can be F/M or whole word\n    switch (attribute) {\n      case 'firstname':\n        return [...users].sort((a, b) =>\n          a.firstname.toLowerCase() > b.firstname.toLowerCase()\n            ? 1\n            : a.firstname.toLowerCase() === b.firstname.toLowerCase()\n            ? a.lastname.toLowerCase() > b.lastname.toLowerCase()\n              ? 1\n              : a.lastname.toLowerCase() === b.lastname.toLowerCase()\n              ? a.age > b.age\n                ? 1\n                : a.age === b.age\n                ? a.sex.toLowerCase().slice(0, 1) >\n                  b.sex.toLowerCase().slice(0, 1)\n                  ? 1\n                  : -1\n                : -1\n              : -1\n            : -1\n        );\n\n      case 'lastname':\n        return [...users].sort((a, b) =>\n          a.lastname.toLowerCase() > b.lastname.toLowerCase()\n            ? 1\n            : a.lastname.toLowerCase() === b.lastname.toLowerCase()\n            ? a.firstname.toLowerCase() > b.firstname.toLowerCase()\n              ? 1\n              : a.firstname.toLowerCase() === b.firstname.toLowerCase()\n              ? a.age > b.age\n                ? 1\n                : a.age === b.age\n                ? a.sex.toLowerCase().slice(0, 1) >\n                  b.sex.toLowerCase().slice(0, 1)\n                  ? 1\n                  : -1\n                : -1\n              : -1\n            : -1\n        );\n\n      case 'sex':\n        return [...users].sort((a, b) =>\n          a.sex.toLowerCase().slice(0, 1) > b.sex.toLowerCase().slice(0, 1)\n            ? 1\n            : a.sex.toLowerCase().slice(0, 1) ===\n              b.sex.toLowerCase().slice(0, 1)\n            ? a.firstname.toLowerCase() > b.firstname.toLowerCase()\n              ? 1\n              : a.firstname.toLowerCase() === b.firstname.toLowerCase()\n              ? a.lastname.toLowerCase() > b.lastname.toLowerCase()\n                ? 1\n                : a.lastname.toLowerCase() === b.lastname.toLowerCase()\n                ? a.age > b.age\n                  ? 1\n                  : -1\n                : -1\n              : -1\n            : -1\n        );\n\n      case 'age':\n        // console.log([...users][0].age);\n        return [...users].sort((a, b) =>\n          a.age > b.age\n            ? 1\n            : a.age === b.age\n            ? a.firstname.toLowerCase() > b.firstname.toLowerCase()\n              ? 1\n              : a.firstname.toLowerCase() === b.firstname.toLowerCase()\n              ? a.lastname.toLowerCase() > b.lastname.toLowerCase()\n                ? 1\n                : a.lastname.toLowerCase() === b.lastname.toLowerCase()\n                ? a.sex.toLowerCase().slice(0, 1) >\n                  b.sex.toLowerCase().slice(0, 1)\n                  ? 1\n                  : -1\n                : -1\n              : -1\n            : -1\n        );\n\n      default:\n        return [...users];\n    }\n  };\n\n  // @ searchUser, selectUser are child functions for setActiveUser\n  const searchUser = (users, queryCur) => {\n    // this func filter users based on search query\n    return users.filter(\n      user =>\n        user.firstname\n          .toLowerCase()\n          .indexOf(queryCur.toString().toLowerCase()) !== -1 ||\n        user.lastname\n          .toLowerCase()\n          .indexOf(queryCur.toString().toLowerCase()) !== -1 ||\n        user.sex.toLowerCase().indexOf(queryCur.toString().toLowerCase()) !==\n          -1 ||\n        user.age.toString().indexOf(queryCur.toString()) !== -1\n    );\n  };\n\n  const selectSort = (sortType, users, actAttr) => {\n    // this func sort users based on sort type\n    switch (sortType) {\n      case 1:\n        return sortUserByAttr(users, actAttr);\n      case 2:\n        return [...sortUserByAttr(users, actAttr)].reverse();\n      default:\n        return users;\n    }\n  };\n\n  // IMPORTANT function to calculate active users\n  const activeUser = (queryCur, sortType, users, actAttr) => {\n    // this func return results after search and then sorting\n    if (queryCur) {\n      const searchedUsers = searchUser(users, queryCur);\n      return selectSort(sortType, searchedUsers, actAttr);\n    } else {\n      return selectSort(sortType, users, actAttr);\n    }\n  };\n  // old expression:\n  // (queryCur\n  //   ? (sortType === 1\n  //       ? sortUserByAttr(users, actAttr)\n  //       : sortType === 2\n  //       ? [...sortUserByAttr(users, actAttr).reverse()]\n  //       : users\n  //     ).filter(user => searchUser(user, queryCur))\n  //   : sortType === 1\n  //   ? sortUserByAttr(users, actAttr)\n  //   : sortType === 2\n  //   ? [...sortUserByAttr(users, actAttr).reverse()]\n  //   : users\n  // )\n  // ------------------------------------------------------------\n\n  //render part ********\n  if (\n    activeUser(queryCur, sortType, users, actAttr).length > 0 &&\n    activeUser(queryCur, sortType, users, actAttr).length ===\n      (activePage - 1) * maxRowsPerPage\n  ) {\n    // if it is this page's last user, after delete, back to prev page\n    // empty list stay in 1st page\n    setActivePage(activePage - 1);\n  }\n\n  return (\n    <div>\n      <nav className='navbar navbar-light bg-light'>\n        <label className='navbar-brand'>User List</label>\n\n        <form className='form-inline' onSubmit={e => handlePageGoTo(e)}>\n          Go to page:{' '}\n          <input\n            className='form-control mr-sm-2'\n            type='goto'\n            placeholder='Go to page'\n            aria-label='GoTo'\n            id='goto'\n            value={goToPage}\n            onChange={e => handleChange(e)}\n          />\n        </form>\n\n        <form className='form-inline' onSubmit={e => handleSearch(e)}>\n          Search:{' '}\n          <input\n            className='form-control mr-sm-2'\n            type='search'\n            placeholder='Search'\n            aria-label='Search'\n            id='search'\n            value={query}\n            onChange={e => handleChange(e)}\n          />\n          {/* <input type='submit' value='Search' /> */}\n        </form>\n\n        {/* <button class=\"btn btn-outline-success my-2 my-sm-0\" type=\"submit\">Search</button> */}\n\n        <button\n          className='btn btn-outline-success'\n          onClick={e => handleCreate()}\n        >\n          <i className='fas fa-user' /> Create\n        </button>\n      </nav>\n      <div>\n        {isLoading ? (\n          <Loading />\n        ) : (\n          <div>\n            <Table\n              queryCur={queryCur}\n              sortType={sortType}\n              users={users}\n              actAttr={actAttr}\n              maxRowsPerPage={maxRowsPerPage}\n              activeUser={activeUser}\n              activePage={activePage}\n              handleDelete={handleDelete}\n              handleEdit={handleEdit}\n              handleSort={handleSort}\n            />\n\n            {/* Pagination Bar */}\n            <Pagination\n              queryCur={queryCur}\n              sortType={sortType}\n              users={users}\n              actAttr={actAttr}\n              maxRowsPerPage={maxRowsPerPage}\n              activeUser={activeUser}\n              activePage={activePage}\n              setActivePage={setActivePage}\n            />\n            {error && <Alert waring='server' item='get' />}\n            {deleteError && <Alert waring='server' item='delete' />}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = state => {\n  return {\n    users: state.users.users,\n    isLoading: state.users.isLoading,\n    error: state.users.error,\n    deleteError: state.users.deleteError\n  };\n};\n\nconst mapStateToDispatch = dispatch => {\n  return {\n    setUserList: () => dispatch(setUserList()),\n    initUser: () => dispatch(initUser()),\n    initEdit: () => dispatch(initEdit()),\n    deleteUser: id => dispatch(deleteUser(id))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapStateToDispatch\n)(Home);"]},"metadata":{},"sourceType":"module"}